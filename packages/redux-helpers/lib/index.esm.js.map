{"version":3,"file":"index.esm.js","sources":["../src/index.js"],"sourcesContent":["const getFailureType = type => `${type}_FAILURE`;\nconst getSuccessType = type => `${type}_SUCCESS`;\n\nconst mergeReducers = (...reducers) => (data, action) =>\n  reducers.reduce((prevData, currentReducer) => currentReducer(prevData, action), data);\n\nconst reduxApiFactory = ({\n  type,\n  request,\n  transform = data => data,\n  defaultValue = null,\n  resetAtRequest = true,\n  dataToRedux = true,\n  resetOnActions = [],\n  reduceOnActions = {},\n  reject = false\n}) => {\n  if (!type) throw new Error('Action type must be defined');\n  if (!request || typeof request !== 'function') {\n    throw new Error(\n      'Action request must be a function (client [, params]) => client.method(endpoint)'\n    );\n  }\n\n  const types = [type, getSuccessType(type), getFailureType(type)];\n\n  const initialState = {\n    loading: false,\n    error: null\n  };\n\n  if (dataToRedux) initialState.data = defaultValue;\n\n  const actionCreator = (params, actionKeys = {}) => ({\n    type: 'api',\n    types,\n    promise: client => request(client, params),\n    reject,\n    params,\n    ...actionKeys\n  });\n\n  const reducers = {\n    [types[0]]: state => ({\n      ...(resetAtRequest ? initialState : state),\n      loading: true,\n      error: null\n    }),\n    [types[1]]: (state, action) => {\n      const returnValue = {\n        loading: false,\n        error: null\n      };\n      if (dataToRedux) returnValue.data = transform(action.payload);\n      return returnValue;\n    },\n    [types[2]]: (state, action) => ({\n      ...state,\n      loading: false,\n      error: action.error\n    }),\n    ...reduceOnActions\n  };\n\n  const reducer = (state = initialState, action) => {\n    if (resetOnActions.indexOf(action.type) !== -1) {\n      return initialState;\n    }\n\n    if (reducers[action.type]) return reducers[action.type](state, action);\n    return state;\n  };\n\n  return {\n    actionCreator,\n    reducer\n  };\n};\n\nconst helper = { getFailureType, getSuccessType, reduxApiFactory };\n\nexport { getFailureType, getSuccessType, mergeReducers, reduxApiFactory };\nexport default helper;\n"],"names":["getFailureType","type","getSuccessType","mergeReducers","reducers","data","action","reduce","prevData","currentReducer","reduxApiFactory","request","transform","defaultValue","resetAtRequest","dataToRedux","resetOnActions","reduceOnActions","reject","Error","types","initialState","loading","error","actionCreator","params","actionKeys","promise","client","state","returnValue","payload","reducer","indexOf","helper"],"mappings":"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"}